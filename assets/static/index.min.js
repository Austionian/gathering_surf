!function(){"use strict";function e(e){if(null==e)throw"item is null or undefined";return e}function t(e){if(null==e)throw"item is null or undefined";if(e instanceof HTMLButtonElement)return e;throw"item is not a button"}function a(t,a){e(document.getElementById(t)).innerText=a}function n(e,t,a){document.getElementById(e)?.setAttribute(t,a)}function i(e,t){e instanceof Array?e.forEach((e=>{n(e,"style",t)})):n(e,"style",t)}function o(e){document.querySelectorAll(e).forEach((e=>e.remove()))}function l(e){document.getElementById(e)?.remove()}function r(e,t){document.getElementById(e)?.classList.remove(t)}function s(e){r(e,"hidden")}function d(e){s(`current-water-quality-${e.water_quality.toLowerCase()}`),a(`current-water-quality-${e.water_quality.toLowerCase()}-status-text`,e.water_quality_text),o(".water-quality-loader")}const c=e=>e.wind_speed===e.gusts||"0"===e.gusts?e.wind_speed:`${e.wind_speed}-${e.gusts}`,u="#a8a29e",g={"#0bd674":"Good","#ffcd1e":"Fair to Good","#ff9500":"Poor","#f4496d":"Very Poor","#a8a29e":"Flat"};let p,m,w,f,v,h,y,x,_,b,E,A;function I(e){e.graph_max;const n=new Date(e.starting_at).getHours();let d=new Date(e.starting_at).getHours();if(n>20){let t=24-n;const a=e.wave_height_labels.length-(e.wave_height_labels.length-t)%24;d=0,m=e.wave_height_labels.slice(t,a),console.log(m),p=e.qualities.slice(t,a),w=e.wave_height_data.slice(t,a),f=e.wind_speed_data.slice(t,a),v=e.wind_direction_data.slice(t,a),h=e.wind_gust_data.slice(t,a),y=e.wave_period_data.slice(t,a),x=e.temperature.slice(t,a),_=e.dewpoint.slice(t,a),b=e.cloud_cover.slice(t,a),E=e.probability_of_precipitation.slice(t,a),A=e.probability_of_thunder.slice(t,a)}else{const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(e.starting_at).getDay()],a=[];for(let e=0;e<n;e++)0!==e?(e<10&&a.push(`${t} 0${e} AM`),e>=10&&e<12&&a.push(`${t} ${e} AM`),12===e&&a.push(`${t} ${e} PM`),e>12&&a.push(`${t} 0${e-12} PM`)):a.push(`${t} 12 AM`);const i=e.wave_height_labels.length+n-(e.wave_height_labels.length+n)%24;m=a.concat(e.wave_height_labels).slice(0,i),p=new Array(n).fill("#a8a29e").concat(e.qualities).slice(0,i),w=new Array(n).fill(0).concat(e.wave_height_data).slice(0,i),f=new Array(n).fill(0).concat(e.wind_speed_data).slice(0,i),v=new Array(n).fill(0).concat(e.wind_direction_data).slice(0,i),h=new Array(n).fill(0).concat(e.wind_gust_data).slice(0,i),y=new Array(n).fill(0).concat(e.wave_period_data).slice(0,i),x=new Array(n).fill(0).concat(e.temperature).slice(0,i),_=new Array(n).fill(0).concat(e.dewpoint).slice(0,i),b=new Array(n).fill(0).concat(e.cloud_cover).slice(0,i),E=new Array(n).fill(0).concat(e.probability_of_precipitation).slice(0,i),A=new Array(n).fill(0).concat(e.probability_of_thunder).slice(0,i)}let c=(new Date).getHours();c=c<0?(new Date).getHours():c;const I=document.getElementById("current-wave-height");""===I?.innerText&&(I.innerText=e.current_wave_height,"0"==e.current_wave_height&&(i("wave-quality",`background-color: ${u}`),a("wave-quality-text",g[u]),i("wave-quality-text",`color: ${u}`),o(".wave-quality-loader")),i("wave-icon",`transform: rotate(${e.current_wave_direction}deg);`),o(".wavey"));const B=document.getElementById("current-wave-period");""===B?.innerText&&(B.innerText=e.current_wave_period,l("wavey-period-loader")),a("legend-label",m[c]),a("legend-quality",g[p[c]]),a("legend-wave-height",w[c]),a("legend-wind-speed",f[c]),i("legend-wind-icon",`transform: rotate(${v[c]}deg);`),a("legend-wave-period",y[c]),a("legend-wind-gust",h[c]),a("forecast-as-of",`Updated @ ${e.forecast_as_of}`),a("forecast-as-of-2",`Forecast Last Ran @ ${e.forecast_as_of}`),o(".loader"),s("forecast"),s("wave-quality"),s("legend-container"),r("forecast-as-of-container","animate-pulse"),r("forecast-as-of-container-2","animate-pulse"),s("temperature-legend-container"),a("temperature-legend-label",m[c]),a("temperature-legend-temperature",x[c]),a("temperature-legend-dewpoint",_[c]),s("precipitation-legend-container"),a("precipitation-legend-label",m[c]),a("precipitation-legend-precipitation",E[c]),a("precipitation-legend-thunder",A[c]),a("precipitation-legend-cloud-cover",b[c]),i("legend",`background-color: ${p[c]};`),i(["legend-container","precipitation-legend-container","temperature-legend-container"],"margin-top: 1rem;");const $=document.getElementById("forecast"),q={id:"vert",defaults:{width:1,dash:[3,3]},afterInit:(e,t,a)=>{e.corsair={x:0,y:0}},afterDraw:(e,t,a)=>{if(e.tooltip?._active?.length){let t=e.tooltip._active[0].element.x,n=e.scales.y,i=e.ctx;i.save(),i.beginPath(),i.moveTo(t,n.top),i.lineTo(t,n.bottom),i.lineWidth=1,i.setLineDash(a.dash),i.strokeStyle="#fff",i.stroke(),i.restore()}if(c-d>H){const t=e.ctx,a=e.scales.x.getPixelForValue(c-d);t.save(),t.strokeStyle="#5b5b58",t.lineWidth=1,t.beginPath(),t.moveTo(a,0),t.lineTo(a,e.height),t.stroke(),t.fillStyle="#5b5b58",t.font="bold 1rem ui-sans-serif, system-ui, sans-serif",t.fillText("Now",c>14&&24===F?a-45:a+5,15),t.restore()}}};function T(e){let t;t=e>=m.length-n?m.length-n-1:e;k(t+(0===H?d:H))}function k(e){const t=p[e];i("legend",`background-color: ${t}`),a("legend-label",m[e]),a("legend-quality",g[t]),a("legend-wave-height",w[e]),a("legend-wind-speed",f[e]),i("legend-wind-icon",`transform: rotate(${v[e]}deg);`),a("legend-wave-period",y[e]),a("legend-wind-gust",h[e]),a("temperature-legend-label",m[e]),a("temperature-legend-temperature",x[e]),a("temperature-legend-dewpoint",_[e]),a("precipitation-legend-label",m[e]),a("precipitation-legend-precipitation",E[e]),a("precipitation-legend-thunder",A[e]),a("precipitation-legend-cloud-cover",b[e])}const L=(e,t,a)=>{const n=Chart.helpers.getRelativePosition(e,a),i=function(e){return 24===F||48===F?e&&e>0?e>=w.length-H?w.length-H-1:e:0:e&&e>0?e>=w.length?w.length-1:e:0}(a.scales.x.getValueForPixel(n.x));T(i)},M=(e,t)=>{const a=0===H?d:H;return 24===F?t%6==0?m[t+a]:null:48===F?t%8==0?m[t+a]:null:t%24==0?m[t+a]:null};const S=()=>window.innerWidth<768?24:window.innerWidth<1024?48:w.length;let F=S(),H=0,C=H+F;const D={size:24===F?14:18,weight:24===F?"lighter":"semi-bold"},P=new Chart($,{type:"bar",plugins:[q],data:{labels:0===H?m.slice(d,C):m.slice(H,C),datasets:[{label:"wave height (feet)",data:0===H?w.slice(d,C):w.slice(H,C),pointStyle:!1,minBarLength:.1}]},options:{aspectRatio:1.75,onHover:L,borderRadius:5,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:e=>(e=>0===H?p[e.dataIndex+d]:p[e.dataIndex+H])(e)||"#4ade80"}},responsive:!0,interaction:{intersect:!1,axis:"x"},scales:{x:{ticks:{callback:M}},y:{grid:{color:"#1B1B1B"},beginAtZero:!0,max:10,ticks:{callback:function(e){return e%2!=0?"":e},font:D}}}}});function R(e){a("forecast-range",e)}function N(){if(0===H){let e=n>20&&(new Date).getHours()>20;R(24===F?e?"Tomorrow":"Today":e?`Tomorrow - ${m[H+25].split(" ")[0]}`:"Today - Tomorrow")}else if(24===F)R(m[H].split(" ")[0]);else{const e=m[C-1]??m[m.length-1];R(`${m[H].split(" ")[0]} - ${e.split(" ")[0]}`)}}function O(){const e=0===H?d:H;let t=m.slice(e,C);P.data.labels=t,P.data.datasets[0].data=w.slice(e,C),P.update(),V.data.labels=t,V.data.datasets[0].data=x.slice(e,C),V.update(),G.data.labels=t,G.data.datasets[0].data=E.slice(e,C),G.update()}N(),window.addEventListener("resize",(()=>{F=S(),H+F>m.length?(C=m.length,H=m.length-F):C=H+F,O(),T(0),0===H&&(t(document.getElementById("forecast-backward")).disabled=!0),H+F<w.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),H+F>=w.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),H>0&&(t(document.getElementById("forecast-backward")).disabled=!1),N()})),document.getElementById("forecast-backward")?.addEventListener("click",(()=>{H-F<0?(H=0,C=F):(C-=F,H-=F),O(),k(c),0===H&&(t(document.getElementById("forecast-backward")).disabled=!0),H+F<w.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),N()})),document.getElementById("forecast-foreward")?.addEventListener("click",(()=>{C+F>m.length?(C=m.length,H=C-F):(H+=F,C+=F),O(),T(0),H+F>=w.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),H>0&&(t(document.getElementById("forecast-backward")).disabled=!1),N()}));const W=(e,t,a,n)=>({type:"bar",plugins:[q],data:{labels:0===H?m.slice(d,C):m.slice(H,C),datasets:[{label:a,data:e,pointStyle:!1,minBarLength:.1}]},options:{aspectRatio:1.75,onHover:L,maintainAspectRatio:!1,borderRadius:5,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:t?{backgroundColor:t,borderColor:t}:{}},responsive:!0,interaction:{intersect:!1,axis:"x"},scales:{x:{ticks:{callback:M}},y:{grid:{color:"#1B1B1B"},beginAtZero:!0,max:n,ticks:{font:D}}}}}),J=document.getElementById("temperature-forecast"),V=new Chart(J,W(0===H?x.slice(d,C):x.slice(H,C),"pink","F",100)),z=document.getElementById("precipitation-forecast"),G=new Chart(z,W(0===H?E.slice(d,C):E.slice(H,C),null,"%",100));function Z(e){const t=P.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,a=t[0].index;V.tooltip.setActiveElements([{datasetIndex:e,index:a}]),V.setActiveElements([{datasetIndex:e,index:a}]),V.update(),G.tooltip.setActiveElements([{datasetIndex:e,index:a}]),G.setActiveElements([{datasetIndex:e,index:a}]),G.update()}else V.tooltip.setActiveElements([],{x:0,y:0}),V.setActiveElements([],{x:0,y:0}),V.update(),G.tooltip.setActiveElements([],{x:0,y:0}),G.setActiveElements([],{x:0,y:0}),G.update()}function U(e){const t=V.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,a=t[0].index;P.tooltip.setActiveElements([{datasetIndex:e,index:a}]),P.setActiveElements([{datasetIndex:e,index:a}]),P.update(),G.tooltip.setActiveElements([{datasetIndex:e,index:a}]),G.setActiveElements([{datasetIndex:e,index:a}]),G.update()}else P.tooltip.setActiveElements([],{x:0,y:0}),P.setActiveElements([],{x:0,y:0}),P.update(),G.tooltip.setActiveElements([],{x:0,y:0}),G.setActiveElements([],{x:0,y:0}),G.update()}function j(e){const t=G.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,a=t[0].index;V.tooltip.setActiveElements([{datasetIndex:e,index:a}]),V.setActiveElements([{datasetIndex:e,index:a}]),V.update(),P.tooltip.setActiveElements([{datasetIndex:e,index:a}]),P.setActiveElements([{datasetIndex:e,index:a}]),P.update()}else V.tooltip.setActiveElements([],{x:0,y:0}),V.setActiveElements([],{x:0,y:0}),V.update(),P.tooltip.setActiveElements([],{x:0,y:0}),P.setActiveElements([],{x:0,y:0}),P.update()}P.canvas.onmousemove=Z,V.canvas.onmousemove=U,G.canvas.onmousemove=j,P.canvas.ontouchmove=Z,V.canvas.ontouchmove=U,G.canvas.ontouchmove=j}const B=e(document.querySelector("body"));new MutationObserver((t=>{for(const u of t)if(u.target instanceof HTMLElement&&("latest-data"===u.target.id&&((n=JSON.parse(u.target.innerText)).wave_height&&(a("current-wave-height",n.wave_height),i("wave-icon",`transform: rotate(${n.wave_direction}deg);`),o(".wavey")),n.wave_period&&(a("current-wave-period",n.wave_period),l("wavey-period-loader")),(""===e(document.getElementById("wave-quality-text")).innerText||n.wave_height||parseFloat(e(document.getElementById("current-wave-height")).innerText??"0")>=1)&&(i("wave-quality",`background-color: ${n.quality_color};`),a("wave-quality-text",n.quality_text),i("wave-quality-text",`color: ${n.quality_color}`),o(".wave-quality-loader")),a("current-water-temp",n.water_temp),a("current-air-temp",n.air_temp),a("current-air-temp-2",n.air_temp),a("wind",c(n)),a("as-of",`As of ${n.as_of}`),i("wind-icon",`transform: rotate(${n.wind_direction+180}deg);`),o(".latest-loader"),s("wind-icon-container"),s("wave-icon-container"),r("as-of-container","animate-pulse"),s("wave-quality")),"water-quality-data"===u.target.id&&d(JSON.parse(u.target.innerText)),"forecast-data"===u.target.id))try{I(JSON.parse(u.target.innerText))}catch{console.log("failed to parse forecast, trying again."),setTimeout((()=>{if(u.target instanceof HTMLElement){I(JSON.parse(u.target.innerText))}}),100)}var n})).observe(B,{attributes:!0,childList:!0,subtree:!0})}();
