!function(){"use strict";function e(e){if(null==e)throw"item is null or undefined";return e}function t(e){if(null==e)throw"item is null or undefined";if(e instanceof HTMLButtonElement)return e;throw"item is not a button"}function n(t,n){e(document.getElementById(t)).innerText=n}function a(e,t,n){var a;null===(a=document.getElementById(e))||void 0===a||a.setAttribute(t,n)}function i(e,t){e instanceof Array?e.forEach((e=>{a(e,"style",t)})):a(e,"style",t)}function o(e){document.querySelectorAll(e).forEach((e=>e.remove()))}function l(e){var t;null===(t=document.getElementById(e))||void 0===t||t.remove()}function r(e,t){var n;null===(n=document.getElementById(e))||void 0===n||n.classList.remove(t)}function s(e){r(e,"hidden")}const d="#a8a29e",c={"#0bd674":"Good","#ffcd1e":"Fair to Good","#ff9500":"Poor","#f4496d":"Very Poor","#a8a29e":"Flat"};let u,g,p,m,v,f,w,y,h,x,b,_;function E(e){var a,E;const A=new Date(e.starting_at).getHours();let I=new Date(e.starting_at).getHours();if(A>20){let t=24-A;const n=e.wave_height_labels.length-(e.wave_height_labels.length-t)%24;I=0,g=e.wave_height_labels.slice(t,n),u=e.quality.slice(t,n),p=e.wave_height.slice(t,n),m=e.wind_speed.slice(t,n),v=e.wind_direction.slice(t,n),f=e.wind_gust.slice(t,n),w=e.wave_period.slice(t,n),y=e.temperature.slice(t,n),h=e.dewpoint.slice(t,n),x=e.cloud_cover.slice(t,n),b=e.probability_of_precipitation.slice(t,n),_=e.probability_of_thunder.slice(t,n)}else{const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(e.starting_at).getDay()],n=[];for(let e=0;e<A;e++)0!==e?(e<10&&n.push(`${t} 0${e} AM`),e>=10&&e<12&&n.push(`${t} ${e} AM`),12===e&&n.push(`${t} ${e} PM`),e>12&&n.push(`${t} 0${e-12} PM`)):n.push(`${t} 12 AM`);const a=e.wave_height_labels.length+A-(e.wave_height_labels.length+A)%24;g=n.concat(e.wave_height_labels).slice(0,a),u=new Array(A).fill("#a8a29e").concat(e.quality).slice(0,a),p=new Array(A).fill(0).concat(e.wave_height).slice(0,a),m=new Array(A).fill(0).concat(e.wind_speed).slice(0,a),v=new Array(A).fill(0).concat(e.wind_direction).slice(0,a),f=new Array(A).fill(0).concat(e.wind_gust).slice(0,a),w=new Array(A).fill(0).concat(e.wave_period).slice(0,a),y=new Array(A).fill(0).concat(e.temperature).slice(0,a),h=new Array(A).fill(0).concat(e.dewpoint).slice(0,a),x=new Array(A).fill(0).concat(e.cloud_cover).slice(0,a),b=new Array(A).fill(0).concat(e.probability_of_precipitation).slice(0,a),_=new Array(A).fill(0).concat(e.probability_of_thunder).slice(0,a)}let q=(new Date).getHours();const $=document.getElementById("current-wave-height");""===(null==$?void 0:$.innerText)&&($.innerText=e.current_wave_height,"0"==e.current_wave_height&&(i("wave-quality",`background-color: ${d}`),n("wave-quality-text",c[d]),i("wave-quality-text",`color: ${d}`),o(".wave-quality-loader")),i("wave-icon",`transform: rotate(${e.current_wave_direction}deg);`),o(".wavey"));const B=document.getElementById("current-wave-period");""===(null==B?void 0:B.innerText)&&(B.innerText=e.current_wave_period,l("wavey-period-loader")),n("legend-label",g[q]),n("legend-quality",c[u[q]]),n("legend-wave-height",p[q]),n("legend-wind-speed",m[q]),i("legend-wind-icon",`transform: rotate(${v[q]+180}deg);`),n("legend-wave-period",w[q]),n("legend-wind-gust",f[q]),n("forecast-as-of",`Updated ${e.as_of}`),n("forecast-as-of-2",`Updated ${e.as_of}`),o(".loader"),s("forecast"),s("wave-quality"),s("legend-container"),r("forecast-as-of-container","animate-pulse"),r("forecast-as-of-container-2","animate-pulse"),s("temperature-legend-container"),n("temperature-legend-label",g[q]),n("temperature-legend-temperature",y[q]),n("temperature-legend-dewpoint",h[q]),s("precipitation-legend-container"),n("precipitation-legend-label",g[q]),n("precipitation-legend-precipitation",b[q]),n("precipitation-legend-thunder",_[q]),n("precipitation-legend-cloud-cover",x[q]),i("legend",`background-color: ${u[q]};`),i(["legend-container","precipitation-legend-container","temperature-legend-container"],"margin-top: 1rem;");const T={id:"vert",defaults:{width:1,dash:[3,3]},afterInit:(e,t,n)=>{e.corsair={x:0,y:0}},afterDraw:(e,t,n)=>{var a,i;if(null===(i=null===(a=e.tooltip)||void 0===a?void 0:a._active)||void 0===i?void 0:i.length){let t=e.tooltip._active[0].element.x,a=e.scales.y,i=e.ctx;i.save(),i.beginPath(),i.moveTo(t,a.top),i.lineTo(t,a.bottom),i.lineWidth=1,i.setLineDash(n.dash),i.strokeStyle="#fff",i.stroke(),i.restore()}if(q-I>H){const t=e.ctx,n=e.scales.x.getPixelForValue(q-I);t.save(),t.strokeStyle="#5b5b58",t.lineWidth=1,t.beginPath(),t.moveTo(n,0),t.lineTo(n,e.height),t.stroke(),t.fillStyle="#5b5b58",t.font="bold 1rem ui-sans-serif, system-ui, sans-serif",t.fillText("Now",q>14&&24===F?n-45:n+5,15),t.restore()}}};function k(e){let t;t=e>=g.length-A?g.length-A-1:e;M(t+(0===H?I:H))}function M(e){const t=u[e];i("legend",`background-color: ${t}`),n("legend-label",g[e]),n("legend-quality",c[t]),n("legend-wave-height",p[e]),n("legend-wind-speed",m[e]),i("legend-wind-icon",`transform: rotate(${v[e]+180}deg);`),n("legend-wave-period",w[e]),n("legend-wind-gust",f[e]),n("temperature-legend-label",g[e]),n("temperature-legend-temperature",y[e]),n("temperature-legend-dewpoint",h[e]),n("precipitation-legend-label",g[e]),n("precipitation-legend-precipitation",b[e]),n("precipitation-legend-thunder",_[e]),n("precipitation-legend-cloud-cover",x[e])}const S=(e,t,n)=>{const a=Chart.helpers.getRelativePosition(e,n),i=function(e){return 24===F||48===F?e&&e>0?e>=p.length-H?p.length-H-1:e:0:e&&e>0?e>=p.length?p.length-1:e:0}(n.scales.x.getValueForPixel(a.x));k(i)},L=(e,t)=>{const n=0===H?I:H;return 24===F?t%6==0?g[t+n]:null:48===F?t%8==0?g[t+n]:null:t%24==0?g[t+n]:null};const C=()=>window.innerWidth<768?24:window.innerWidth<1024?48:p.length;let F=C(),H=0,O=H+F;const P={size:24===F?14:18,weight:"semi-bold"},D=e=>({aspectRatio:1.75,onHover:S,borderRadius:5,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},responsive:!0,interaction:{intersect:!1,axis:"x"},scales:{x:{ticks:{callback:L}},y:{grid:{color:"#1B1B1B"},beginAtZero:!0,max:null!=e?e:10,ticks:{callback:function(e){return e%2!=0?"":e},font:P}}}}),j=new Chart(document.getElementById("forecast"),{type:"bar",plugins:[T],data:{labels:0===H?g.slice(I,O):g.slice(H,O),datasets:[{label:"wave height (feet)",data:0===H?p.slice(I,O):p.slice(H,O),pointStyle:!1,minBarLength:.1}]},options:Object.assign(Object.assign({},D(void 0)),{elements:{bar:{backgroundColor:e=>(e=>0===H?u[e.dataIndex+I]:u[e.dataIndex+H])(e)||"#4ade80"}}})});function N(e){n("forecast-range",e)}function W(){var e;if(0===H){let e=A>20&&(new Date).getHours()>20;N(24===F?e?"Tomorrow":"Today":e?`Tomorrow - ${g[H+25].split(" ")[0]}`:"Today - Tomorrow")}else if(24===F)N(g[H].split(" ")[0]);else{const t=null!==(e=g[O-1])&&void 0!==e?e:g[g.length-1];N(`${g[H].split(" ")[0]} - ${t.split(" ")[0]}`)}}function J(){const e=0===H?I:H;let t=g.slice(e,O);j.data.labels=t,j.data.datasets[0].data=p.slice(e,O),j.update(),V.data.labels=t,V.data.datasets[0].data=y.slice(e,O),V.update(),G.data.labels=t,G.data.datasets[0].data=b.slice(e,O),G.update()}W(),window.addEventListener("resize",(()=>{F=C(),H+F>g.length?(O=g.length,H=g.length-F):O=H+F,J(),k(0),0===H&&(t(document.getElementById("forecast-backward")).disabled=!0),H+F<p.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),H+F>=p.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),H>0&&(t(document.getElementById("forecast-backward")).disabled=!1),W()})),null===(a=document.getElementById("forecast-backward"))||void 0===a||a.addEventListener("click",(()=>{H-F<0?(H=0,O=F):(O-=F,H-=F),J(),0===H?M(q):k(0),0===H&&(t(document.getElementById("forecast-backward")).disabled=!0),H+F<p.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),W()})),null===(E=document.getElementById("forecast-foreward"))||void 0===E||E.addEventListener("click",(()=>{O+F>g.length?(O=g.length,H=O-F):(H+=F,O+=F),J(),k(0),H+F>=p.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),H>0&&(t(document.getElementById("forecast-backward")).disabled=!1),W()}));const R=(e,t,n)=>({type:"bar",plugins:[T],data:{labels:0===H?g.slice(I,O):g.slice(H,O),datasets:[{label:n,data:e,pointStyle:!1,minBarLength:.1}]},options:Object.assign(Object.assign({},D(100)),{elements:{bar:t?{backgroundColor:t,borderColor:t}:{}}})}),U=document.getElementById("temperature-forecast"),V=new Chart(U,R(0===H?y.slice(I,O):y.slice(H,O),"pink","F")),z=document.getElementById("precipitation-forecast"),G=new Chart(z,R(0===H?b.slice(I,O):b.slice(H,O),null,"%"));function Z(e){const t=j.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;V.tooltip.setActiveElements([{datasetIndex:e,index:n}]),V.setActiveElements([{datasetIndex:e,index:n}]),V.update(),G.tooltip.setActiveElements([{datasetIndex:e,index:n}]),G.setActiveElements([{datasetIndex:e,index:n}]),G.update()}else V.tooltip.setActiveElements([],{x:0,y:0}),V.setActiveElements([],{x:0,y:0}),V.update(),G.tooltip.setActiveElements([],{x:0,y:0}),G.setActiveElements([],{x:0,y:0}),G.update()}function K(e){const t=V.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;j.tooltip.setActiveElements([{datasetIndex:e,index:n}]),j.setActiveElements([{datasetIndex:e,index:n}]),j.update(),G.tooltip.setActiveElements([{datasetIndex:e,index:n}]),G.setActiveElements([{datasetIndex:e,index:n}]),G.update()}else j.tooltip.setActiveElements([],{x:0,y:0}),j.setActiveElements([],{x:0,y:0}),j.update(),G.tooltip.setActiveElements([],{x:0,y:0}),G.setActiveElements([],{x:0,y:0}),G.update()}function Q(e){const t=G.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;V.tooltip.setActiveElements([{datasetIndex:e,index:n}]),V.setActiveElements([{datasetIndex:e,index:n}]),V.update(),j.tooltip.setActiveElements([{datasetIndex:e,index:n}]),j.setActiveElements([{datasetIndex:e,index:n}]),j.update()}else V.tooltip.setActiveElements([],{x:0,y:0}),V.setActiveElements([],{x:0,y:0}),V.update(),j.tooltip.setActiveElements([],{x:0,y:0}),j.setActiveElements([],{x:0,y:0}),j.update()}j.canvas.onmousemove=Z,V.canvas.onmousemove=K,G.canvas.onmousemove=Q,j.canvas.ontouchmove=Z,V.canvas.ontouchmove=K,G.canvas.ontouchmove=Q}const A=e=>e.wind_speed===e.gusts||"0"===e.gusts?e.wind_speed:`${e.wind_speed}-${e.gusts}`;function I(e){o(".water-quality-loader"),s("current-water-quality"),n("current-water-quality-title","Closed for season"===e.water_quality?"-----":e.water_quality.toUpperCase()),n("current-water-quality-status-text",e.water_quality_text),"Advisory"===e.water_quality&&i("current-water-quality-title","color: #facc15;"),"Closed"===e.water_quality&&i("current-water-quality-title","color: #ef4444;")}function q(t){var n,a;l("forecast-container"),n="forecast-error",a=`\n    <div class="p-12 flex flex-col items-center align-middle justify-center text-center">\n      <h2 class="text-xl font-mono">\n      Error loading forecast data - please refresh the page or try again later.\n      </h2>\n      <p>${t}</p>\n    </div>\n    `,e(document.getElementById(n)).innerHTML=a}const $=document.querySelector("body");new MutationObserver((t=>{for(const c of t)if(c.target instanceof HTMLElement&&("realtime-data"===c.target.id&&(a=JSON.parse(c.target.innerText),d=void 0,a.wave_height&&(n("current-wave-height",a.wave_height),i("wave-icon",`transform: rotate(${a.wave_direction}deg);`),o(".wavey")),a.wave_period&&(n("current-wave-period",a.wave_period),l("wavey-period-loader")),(""===e(document.getElementById("wave-quality-text")).innerText||a.wave_height||parseFloat(null!==(d=e(document.getElementById("current-wave-height")).innerText)&&void 0!==d?d:"0")>=1)&&(i("wave-quality",`background-color: ${a.quality_color};`),n("wave-quality-text",a.quality_text),i("wave-quality-text",`color: ${a.quality_color}`),o(".wave-quality-loader")),n("current-water-temp",a.water_temp),n("current-air-temp",a.air_temp),n("current-air-temp-2",a.air_temp),n("wind",A(a)),n("as-of",`As of ${a.as_of}`),i("wind-icon",`transform: rotate(${a.wind_direction+180}deg);`),o(".latest-loader"),s("wind-icon-container"),s("wave-icon-container"),r("as-of-container","animate-pulse"),s("wave-quality")),"water-quality-data"===c.target.id&&I(JSON.parse(c.target.innerText)),"forecast-data"===c.target.id))try{E(JSON.parse(c.target.innerText))}catch(d){console.log("failed to parse forecast, trying again."),setTimeout((()=>{if(c.target instanceof HTMLElement)try{E(JSON.parse(c.target.innerText))}catch(e){q(e)}}),100)}var a,d})).observe($,{attributes:!0,childList:!0,subtree:!0})}();
