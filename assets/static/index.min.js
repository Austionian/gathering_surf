!function(){"use strict";function e(e){if(null==e)throw"item is null or undefined";return e}function t(e){if(null==e)throw"item is null or undefined";if(e instanceof HTMLButtonElement)return e;throw"item is not a button"}function n(t,n){e(document.getElementById(t)).innerText=n}function a(e,t){!function(e,t,n){document.getElementById(e)?.setAttribute(t,n)}(e,"style",t)}function i(e){document.querySelectorAll(e).forEach((e=>e.remove()))}function o(e){document.getElementById(e)?.remove()}function l(e,t){document.getElementById(e)?.classList.remove(t)}function r(e){l(e,"hidden")}function s(e){r(`current-water-quality-${e.water_quality.toLowerCase()}`),n(`current-water-quality-${e.water_quality.toLowerCase()}-status-text`,e.water_quality_text),i(".water-quality-loader")}const d=e=>e.wind_speed===e.gusts||"0"===e.gusts?e.wind_speed:`${e.wind_speed}-${e.gusts}`,c="#a8a29e",u={"#0bd674":"Good","#ffcd1e":"Fair to Good","#ff9500":"Poor","#f4496d":"Very Poor","#a8a29e":"Flat"};let g,p,m,w,f,v,y,h,x,_,b,E,A;function I(e){h=e.graph_max;const s=new Date(e.starting_at).getHours();if(s>20){let t=24-s;const n=p.length-(p.length-t)%24;p=e.wave_height_labels.slice(t,n),g=e.qualities.slice(t,n),m=e.wave_height_data.slice(t,n),w=e.wind_speed_data.slice(t,n),f=e.wind_direction_data.slice(t,n),v=e.wind_gust_data.slice(t,n),y=e.wave_period_data.slice(t,n),x=e.temperature.slice(t,n),_=e.dewpoint.slice(t,n),b=e.cloud_cover.slice(t,n),E=e.probability_of_precipitation.slice(t,n),A=e.probability_of_thunder.slice(t,n)}else{const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(e.starting_at).getDay()],n=[];for(let e=0;e<s;e++)0!==e?(e<10&&n.push(`${t} 0${e} AM`),e>=10&&e<12&&n.push(`${t} ${e} AM`),12===e&&n.push(`${t} ${e} PM`),e>12&&n.push(`${t} 0${e-12} PM`)):n.push(`${t} 12 AM`);const a=e.wave_height_labels.length+s-(e.wave_height_labels.length+s)%24;p=n.concat(e.wave_height_labels).slice(0,a),g=new Array(s).fill("#a8a29e").concat(e.qualities).slice(0,a),m=new Array(s).fill(0).concat(e.wave_height_data).slice(0,a),w=new Array(s).fill(0).concat(e.wind_speed_data).slice(0,a),f=new Array(s).fill(0).concat(e.wind_direction_data).slice(0,a),v=new Array(s).fill(0).concat(e.wind_gust_data).slice(0,a),y=new Array(s).fill(0).concat(e.wave_period_data).slice(0,a),x=new Array(s).fill(0).concat(e.temperature).slice(0,a),_=new Array(s).fill(0).concat(e.dewpoint).slice(0,a),b=new Array(s).fill(0).concat(e.cloud_cover).slice(0,a),E=new Array(s).fill(0).concat(e.probability_of_precipitation).slice(0,a),A=new Array(s).fill(0).concat(e.probability_of_thunder).slice(0,a)}let d=(new Date).getHours();const I=new Date(e.starting_at).getHours();d=d<0?(new Date).getHours():d;const $=document.getElementById("current-wave-height");""===$?.innerText&&($.innerText=e.current_wave_height,"0"==e.current_wave_height&&(a("wave-quality",`background-color: ${c}`),n("wave-quality-text",u[c]),a("wave-quality-text",`color: ${c}`),i(".wave-quality-loader")),a("wave-icon",`transform: rotate(${e.current_wave_direction}deg);`),i(".wavey"));const q=document.getElementById("current-wave-period");""===q?.innerText&&(q.innerText=e.current_wave_period,o("wavey-period-loader")),n("legend-label",p[d]),n("legend-quality",u[g[d]]),n("legend-wave-height",m[d]),n("legend-wind-speed",w[d]),a("legend-wind-icon",`transform: rotate(${f[d]}deg);`),n("legend-wave-period",y[d]),n("legend-wind-gust",v[d]),n("forecast-as-of",`Updated @ ${e.forecast_as_of}`),n("forecast-as-of-2",`Forecast Last Ran @ ${e.forecast_as_of}`),i(".loader"),r("forecast"),r("wave-quality"),r("legend-container"),l("forecast-as-of-container","animate-pulse"),l("forecast-as-of-container-2","animate-pulse"),r("temperature-legend-container"),n("temperature-legend-label",p[d]),n("temperature-legend-temperature",x[d]),n("temperature-legend-dewpoint",_[d]),r("precipitation-legend-container"),n("precipitation-legend-label",p[d]),n("precipitation-legend-precipitation",E[d]),n("precipitation-legend-thunder",A[d]),n("precipitation-legend-cloud-cover",b[d]),a("legend",`background-color: ${g[d]};`);const T=document.getElementById("forecast"),k={id:"vert",defaults:{width:1,dash:[3,3]},afterInit:(e,t,n)=>{e.corsair={x:0,y:0}},afterDraw:(e,t,n)=>{if(e.tooltip?._active?.length){let t=e.tooltip._active[0].element.x,a=e.scales.y,i=e.ctx;i.save(),i.beginPath(),i.moveTo(t,a.top),i.lineTo(t,a.bottom),i.lineWidth=1,i.setLineDash(n.dash),i.strokeStyle="#fff",i.stroke(),i.restore()}if(d-I>C){const t=e.ctx,n=e.scales.x.getPixelForValue(d-I);t.save(),t.strokeStyle="#3b3b42",t.lineWidth=1,t.beginPath(),t.moveTo(n,0),t.lineTo(n,e.height),t.stroke(),t.fillStyle="#3b3b42",t.font="bold 1rem ui-sans-serif, system-ui, sans-serif",t.fillText("Now",d>14&&24===H?n-45:n+5,15),t.restore()}}};function B(e){let t;t=e>=p.length-s?p.length-s-1:e;L(t+(0===C?I:C))}function L(e){const t=g[e];a("legend",`background-color: ${t}`),n("legend-label",p[e]),n("legend-quality",u[t]),n("legend-wave-height",m[e]),n("legend-wind-speed",w[e]),a("legend-wind-icon",`transform: rotate(${f[e]}deg);`),n("legend-wave-period",y[e]),n("legend-wind-gust",v[e]),n("temperature-legend-label",p[e]),n("temperature-legend-temperature",x[e]),n("temperature-legend-dewpoint",_[e]),n("precipitation-legend-label",p[e]),n("precipitation-legend-precipitation",E[e]),n("precipitation-legend-thunder",A[e]),n("precipitation-legend-cloud-cover",b[e])}const M=(e,t,n)=>{const a=Chart.helpers.getRelativePosition(e,n),i=function(e){return 24===H||48===H?e&&e>0?e>=m.length-C?m.length-C-1:e:0:e&&e>0?e>=m.length?m.length-1:e:0}(n.scales.x.getValueForPixel(a.x));B(i)},S=(e,t)=>{const n=0===C?I:C;return 24===H?t%6==0?p[t+n]:null:48===H?t%8==0?p[t+n]:null:t%24==0?p[t+n]:null};const F=()=>window.innerWidth<768?24:window.innerWidth<1024?48:m.length;let H=F(),C=0,D=C+H;const P={size:24===H?14:18,weight:24===H?"lighter":"semi-bold"},R=new Chart(T,{type:"bar",plugins:[k],data:{labels:0===C?p.slice(I,D):p.slice(C,D),datasets:[{label:"wave height (feet)",data:0===C?m.slice(I,D):m.slice(C,D),pointStyle:!1,minBarLength:.1}]},options:{onHover:M,borderRadius:5,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:e=>(e=>0===C?g[e.dataIndex+I]:g[e.dataIndex+C])(e)||"#4ade80"}},responsive:!0,interaction:{intersect:!1,axis:"x"},scales:{x:{ticks:{callback:S}},y:{beginAtZero:!0,max:h,ticks:{callback:function(e){return e%2!=0?"":e},font:P}}}}});function N(e){n("forecast-range",e)}function O(){if(0===C){let e=s>20&&(new Date).getHours()>20;N(24===H?e?"Tomorrow":"Today":e?`Tomorrow - ${p[C+25].split(" ")[0]}`:"Today - Tomorrow")}else if(24===H)N(p[C].split(" ")[0]);else{const e=p[D-1]??p[p.length-1];N(`${p[C].split(" ")[0]} - ${e.split(" ")[0]}`)}}function W(){const e=0===C?I:C;let t=p.slice(e,D);R.data.labels=t,R.data.datasets[0].data=m.slice(e,D),R.update(),z.data.labels=t,z.data.datasets[0].data=x.slice(e,D),z.update(),Z.data.labels=t,Z.data.datasets[0].data=E.slice(e,D),Z.update()}O(),window.addEventListener("resize",(()=>{H=F(),C+H>p.length?(D=p.length,C=p.length-H):D=C+H,W(),B(0),0===C&&(t(document.getElementById("forecast-backward")).disabled=!0),C+H<m.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),C+H>=m.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),C>0&&(t(document.getElementById("forecast-backward")).disabled=!1),O()})),document.getElementById("forecast-backward")?.addEventListener("click",(()=>{C-H<0?(C=0,D=H):(D-=H,C-=H),W(),L(d),0===C&&(t(document.getElementById("forecast-backward")).disabled=!0),C+H<m.length&&(t(document.getElementById("forecast-foreward")).disabled=!1),O()})),document.getElementById("forecast-foreward")?.addEventListener("click",(()=>{D+H>p.length?(D=p.length,C=D-H):(C+=H,D+=H),W(),B(0),C+H>=m.length&&(t(document.getElementById("forecast-foreward")).disabled=!0),C>0&&(t(document.getElementById("forecast-backward")).disabled=!1),O()}));const J=(e,t,n,a)=>({type:"bar",plugins:[k],data:{labels:0===C?p.slice(I,D):p.slice(C,D),datasets:[{label:n,data:e,pointStyle:!1,minBarLength:.1}]},options:{stacked:!0,onHover:M,maintainAspectRatio:!1,borderRadius:5,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:t?{backgroundColor:t,borderColor:t}:{}},responsive:!0,interaction:{intersect:!1,axis:"x"},scales:{x:{ticks:{callback:S}},y:{beginAtZero:!0,max:a,ticks:{font:P}}}}}),V=document.getElementById("temperature-forecast"),z=new Chart(V,J(0===C?x.slice(I,D):x.slice(C,D),"pink","F",100)),G=document.getElementById("precipitation-forecast"),Z=new Chart(G,J(0===C?E.slice(I,D):E.slice(C,D),null,"%",100));function U(e){const t=R.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;z.tooltip.setActiveElements([{datasetIndex:e,index:n}]),z.setActiveElements([{datasetIndex:e,index:n}]),z.update(),Z.tooltip.setActiveElements([{datasetIndex:e,index:n}]),Z.setActiveElements([{datasetIndex:e,index:n}]),Z.update()}else z.tooltip.setActiveElements([],{x:0,y:0}),z.setActiveElements([],{x:0,y:0}),z.update(),Z.tooltip.setActiveElements([],{x:0,y:0}),Z.setActiveElements([],{x:0,y:0}),Z.update()}function j(e){const t=z.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;R.tooltip.setActiveElements([{datasetIndex:e,index:n}]),R.setActiveElements([{datasetIndex:e,index:n}]),R.update(),Z.tooltip.setActiveElements([{datasetIndex:e,index:n}]),Z.setActiveElements([{datasetIndex:e,index:n}]),Z.update()}else R.tooltip.setActiveElements([],{x:0,y:0}),R.setActiveElements([],{x:0,y:0}),R.update(),Z.tooltip.setActiveElements([],{x:0,y:0}),Z.setActiveElements([],{x:0,y:0}),Z.update()}function K(e){const t=Z.getElementsAtEventForMode(e,"nearest",{axis:"x",intersect:!1},!0);if(t[0]){const e=t[0].datasetIndex,n=t[0].index;z.tooltip.setActiveElements([{datasetIndex:e,index:n}]),z.setActiveElements([{datasetIndex:e,index:n}]),z.update(),R.tooltip.setActiveElements([{datasetIndex:e,index:n}]),R.setActiveElements([{datasetIndex:e,index:n}]),R.update()}else z.tooltip.setActiveElements([],{x:0,y:0}),z.setActiveElements([],{x:0,y:0}),z.update(),R.tooltip.setActiveElements([],{x:0,y:0}),R.setActiveElements([],{x:0,y:0}),R.update()}R.canvas.onmousemove=U,z.canvas.onmousemove=j,Z.canvas.onmousemove=K,R.canvas.ontouchmove=U,z.canvas.ontouchmove=j,Z.canvas.ontouchmove=K}const $=e(document.querySelector("body"));new MutationObserver((t=>{for(const u of t)if(u.target instanceof HTMLElement&&("latest-data"===u.target.id&&((c=JSON.parse(u.target.innerText)).wave_height&&(n("current-wave-height",c.wave_height),a("wave-icon",`transform: rotate(${c.wave_direction}deg);`),i(".wavey")),c.wave_period&&(n("current-wave-period",c.wave_period),o("wavey-period-loader")),(""===e(document.getElementById("wave-quality-text")).innerText||c.wave_height||parseFloat(e(document.getElementById("current-wave-height")).innerText??"0")>=1)&&(a("wave-quality",`background-color: ${c.quality_color};`),n("wave-quality-text",c.quality_text),a("wave-quality-text",`color: ${c.quality_color}`),i(".wave-quality-loader")),n("current-water-temp",c.water_temp),n("current-air-temp",c.air_temp),n("current-air-temp-2",c.air_temp),n("wind",d(c)),n("as-of",`As of ${c.as_of}`),a("wind-icon",`transform: rotate(${c.wind_direction+180}deg);`),i(".latest-loader"),r("wind-icon-container"),r("wave-icon-container"),l("as-of-container","animate-pulse"),r("wave-quality")),"water-quality-data"===u.target.id&&s(JSON.parse(u.target.innerText)),"forecast-data"===u.target.id))try{I(JSON.parse(u.target.innerText))}catch{console.log("failed to parse forecast, trying again."),setTimeout((()=>{if(u.target instanceof HTMLElement){I(JSON.parse(u.target.innerText))}}),100)}var c})).observe($,{attributes:!0,childList:!0,subtree:!0})}();
